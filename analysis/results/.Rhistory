library(ggplot2)
library(tidyr)
library(dplyr)
library(magrittr)
# ~~~~~~~ Grabbing Style Of Each Question ~~~~~~~
load("/Users/lancefernando/Desktop/Research/VGLResearch/DefaultAesthetics/Data/Question_Difficulty.RData")
# Creating a vector of all question names
all_questions <- unique(Question.Difficulty$Type)
# Takes a given user observation and looks at the question that was answered
# to return the style of graph that was in the question
getStyle <- function(user, all_questions){
style_seq <- as.character(user$style_seq)
question <- user$Type
q_ind <- which(all_questions %in% question)
q_ind <- ifelse(q_ind > 24, q_ind %% 24, q_ind)
q_ind <- ifelse(q_ind > 4, q_ind %% 4, q_ind)
q_ind <- ifelse(q_ind == 0, 4, q_ind)
styles <- strsplit(x = style_seq, split = "-")[[1]]
return(styles[q_ind])
}
# Creating `style` column with style value for each question
style <- rep(NA, nrow(Question.Difficulty))
for(i in 1 : nrow(Question.Difficulty)){
style[i] <- getStyle(Question.Difficulty[i,], all_questions = all_questions)
}
# Adding to dataframe
Question.Difficulty$style <- as.factor(style)
# Filtering out bad questions
bad_questions <- c("X1_Q4.2_res", "X2_Q4.2_res", "X3_Q4.2_res", "X4_Q4.2_res", "X5_Q4.2_res",
"X6_Q4.2_res", "X7_Q4.2_res", "X8_Q4.2_res", "X22_Q4.2_res")
Question.Difficulty.Filtered <- filter(Question.Difficulty, !Type %in% bad_questions)
t1_data <- Question.Difficulty.Filtered[Question.Difficulty.Filtered$task == "task1",]
t1_plot <- ggplot(data = t1_data[t1_data$Correct == TRUE,])
t1_plot + geom_bar(mapping = aes(x = style, fill = style), show.legend = FALSE) +
labs(title = "Task 1: Number of Correct Answers by Tool", x = "Tool", y="Count") +
facet_grid(~Q2.4)
style_table <- table(t1_data$style, t1_data$Correct)
cat("P-value: ", chisq.test(style_table)$p.value, sep="")
t1_data <- Question.Difficulty.Filtered[Question.Difficulty.Filtered$task == "task1",]
t1_plot <- ggplot(data = t1_data[t1_data$Correct == TRUE,])
t1_plot + geom_bar(mapping = aes(x = style, fill = style), show.legend = FALSE) +
labs(title = "Task 1: Number of Correct Answers by Tool", x = "Tool", y="Count")
style_table <- table(t1_data$style, t1_data$Correct)
cat("P-value: ", chisq.test(style_table)$p.value, sep="")
t1_plot + geom_bar(mapping = aes(x = style, fill = style), show.legend = FALSE) +
labs(title = "Task 1: Number of Correct Answers by Tool", x = "Tool", y="Count") +
coord_cartesian(ylim = c(500, 650))
t1_plot + geom_bar(mapping = aes(x = style, fill = style), show.legend = FALSE) +
labs(title = "Task 1: Number of Correct Answers by Tool", x = "Tool", y="Count") +
coord_cartesian(ylim = c(500, 700))
table(t1_data$style)
total <- table(Question.Difficulty.Filtered$style, Question.Difficulty.Filtered$size)
sub_correct <- Question.Difficulty.Filtered[Question.Difficulty.Filtered$Correct == TRUE,]
correct <- table(sub_correct$style, sub_correct$size)
new_table <- correct/total
new_data <- as.data.frame(correct / total)
ggplot(data = new_data)+
geom_bar(mapping = aes(x = Var1, fill = Var1, y = Freq),
position = "dodge",
stat = "identity") +
labs(title = "Task 1: Proportion of Correct Answers by Tool and Size ", y = "Proportion") +
coord_cartesian() +
facet_grid(~Var2)
cat("Overall p-value: ", chisq.test(sub_correct$style, sub_correct$size))
cat("Overall p-value: ", chisq.test(sub_correct$style, sub_correct$size)$p.value)
cat("Overall p-value: ", chisq.test(table(sub_correct$style, sub_correct$size))$p.value)
cat("Overall p-value: ", chisq.test(correct)$p.value)
cat("Partitioned on `large` questions p-value: ", chisq.test(large_table)$p.value, sep="")
cat("Overall p-value: ", chisq.test(correct)$p.value)
t1_sub_large <- t1_data[t1_data$size == "large",]
large_table <- table(t1_sub_large$style, t1_sub_large$Correct)
cat("Partitioned on `large` questions p-value: ", chisq.test(large_table)$p.value, sep="")
t1_sub_med <- t1_data[t1_data$size == "med",]
med_table <- table(t1_sub_med$style, t1_sub_med$Correct)
cat("Partitioned on `medium` questions p-value: ", chisq.test(med_table)$p.value, sep="")
t1_sub_small <- t1_data[t1_data$size == "small",]
small_table <- table(t1_sub_small$style, t1_sub_small$Correct)
cat("Partitioned on `small` questions p-value: ", chisq.test(small_table)$p.value, sep="")
t1_plot + geom_bar(mapping = aes(x = style, fill = style), show.legend = FALSE) +
labs(title = "Task 1: Number of Correct Answers by Tool", x = "Tool", y="Count") +
coord_cartesian(ylim = c(500, 700))
style_table <- table(t1_data$style, t1_data$Correct)
cat("P-value: ", chisq.test(style_table)$p.value, sep="")
t2_data <- Question.Difficulty[Question.Difficulty$task == "task2",]
t2_plot <- ggplot(data = t2_data[t2_data$Correct == TRUE,])
t2_plot + geom_bar(mapping = aes(x = style, fill = style), show.legend = FALSE) +
labs(title = "Task 2: Number of Correct Answers by Tool", x = "Tool", y="Count") +
coord_cartesian(ylim=c(790, 832))
curr_table <- table(t2_data$style, t2_data$Correct)
cat("P-value: ", chisq.test(curr_table)$p.value, sep = "")
t2_plot + geom_bar(mapping = aes(x = style, fill = style), position = "dodge") +
labs(title = "Task 2: Number of Correct Answers by Tool and Difficulty ") +
coord_cartesian(ylim = c(350, 455)) +
facet_grid(~diff)
t2_plot + geom_bar(mapping = aes(x = style, fill = style), position = "dodge") +
labs(title = "Task 2: Number of Correct Answers by Tool and Difficulty ") +
coord_cartesian(ylim = c(350, 455)) +
facet_grid(~diff)
t2_sub_easy <- t2_data[t2_data$diff == "easy",]
t2_sub_easy <- t2_data[t2_data$diff == "easy",]
easy_table <- table(t2_sub_easy$style, t2_sub_easy$Correct)
easy_table <- table(t2_sub_easy$style, t2_sub_easy$Correct)
cat("Partitioned on `easy` questions p-value: ", chisq.test(easy_table)$p.value, sep="")
t2_sub_hard <- t2_data[t2_data$diff == "hard",]
hard_table <- table(t2_sub_hard$style, t2_sub_hard$Correct)
cat("Partitioned on `hard` questions p-value: ", chisq.test(hard_table)$p.value, sep="")
total <- table(Question.Difficulty.Filtered$style, Question.Difficulty.Filtered$size)
sub_correct <- Question.Difficulty.Filtered[Question.Difficulty.Filtered$Correct == TRUE,]
correct <- table(sub_correct$style, sub_correct$size)
new_table <- correct/total
new_table
ggplot(data = new_data)+
geom_bar(mapping = aes(x = Var1, fill = Var1, y = Freq),
position = "dodge",
stat = "identity") +
labs(title = "Task 1: Proportion of Correct Answers by Tool and Size ", y = "Proportion") +
coord_cartesian(ylim = c(0.75,0.81)) +
facet_grid(~Var2)
t2_plot + geom_bar(mapping = aes(x = style, fill = style), position = "dodge") +
labs(title = "Task 2: Number of Correct Answers by Tool and Difficulty ") +
coord_cartesian(ylim = c(350, 455)) +
facet_grid(~diff)
t2_sub_easy <- t2_data[t2_data$diff == "easy",]
easy_table <- table(t2_sub_easy$style, t2_sub_easy$Correct)
cat("Partitioned on `easy` questions p-value: ", chisq.test(easy_table)$p.value, sep="")
t2_sub_hard <- t2_data[t2_data$diff == "hard",]
hard_table <- table(t2_sub_hard$style, t2_sub_hard$Correct)
cat("Partitioned on `hard` questions p-value: ", chisq.test(hard_table)$p.value, sep="")
t2_plot + geom_bar(mapping = aes(x = style, fill = style), position = "dodge") +
labs(title = "Task 2: Number of Correct Answers by Tool and Size ") +
coord_cartesian(ylim = c(250,290)) +
facet_grid(~size)
t2_sub_large <- t2_data[t2_data$size == "large",]
large_table <- table(t2_sub_large$style, t2_sub_large$Correct)
cat("Partitioned on `large` questions p-value: ", chisq.test(large_table)$p.value, sep="")
setwd("~Users")
setwd("~/Users")
setwd("~/Users/")
setwd("~Users/")
setwd("/Users/lancefernando/Desktop/Research/VGLResearch/splom-studies/analysis/results")
install.packages("rjson")
library(rjson)
results <- fromJSON(file = "data.json")
results <- as.data.frame(fromJSON(file = "data.json"))
View(results)
names(results)
results <- as.data.frame(fromJSON(file = "data.json"))
View(results)
names(results)
json_file <- lapply(json_file, function(x) {
x[sapply(x, is.null)] <- NA
unlist(x)
})
results <- fromJSON(file = "data.json")
json_file <- fromJSON(file = "data.json")
json_file <- lapply(json_file, function(x) {
x[sapply(x, is.null)] <- NA
unlist(x)
})
do.call("rbind", json_file)
test <- do.call("rbind", json_file)
View(test)
library(ggplot2)
library(tidyr)
library(dplyr)
library(magrittr)
# ~~~~~~~ Grabbing Style Of Each Question ~~~~~~~
load("/Users/lancefernando/Desktop/Research/VGLResearch/DefaultAesthetics/Data/Question_Difficulty.RData")
# Creating a vector of all question names
all_questions <- unique(Question.Difficulty$Type)
# Takes a given user observation and looks at the question that was answered
# to return the style of graph that was in the question
getStyle <- function(user, all_questions){
style_seq <- as.character(user$style_seq)
question <- user$Type
q_ind <- which(all_questions %in% question)
q_ind <- ifelse(q_ind > 24, q_ind %% 24, q_ind)
q_ind <- ifelse(q_ind > 4, q_ind %% 4, q_ind)
q_ind <- ifelse(q_ind == 0, 4, q_ind)
styles <- strsplit(x = style_seq, split = "-")[[1]]
return(styles[q_ind])
}
# Creating `style` column with style value for each question
style <- rep(NA, nrow(Question.Difficulty))
for(i in 1 : nrow(Question.Difficulty)){
style[i] <- getStyle(Question.Difficulty[i,], all_questions = all_questions)
}
# Adding to dataframe
Question.Difficulty$style <- as.factor(style)
# Filtering out bad questions
bad_questions <- c("X1_Q4.2_res", "X2_Q4.2_res", "X3_Q4.2_res", "X4_Q4.2_res", "X5_Q4.2_res",
"X6_Q4.2_res", "X7_Q4.2_res", "X8_Q4.2_res", "X22_Q4.2_res")
Question.Difficulty.Filtered <- filter(Question.Difficulty, !Type %in% bad_questions)
ggplot(data = Question.Difficulty.Filtered) +
geom_bar(mapping = aes(x = style, fill = style))
ggplot(data = Question.Difficulty.Filtered[Question.Difficulty.Filtered$Correct == TRUE,]) +
geom_bar(mapping = aes(x = style, fill = style))
chisq.test(table(Question.Difficulty.Filtered$Correct, Question.Difficulty.Filtered$style))
ggplot(data = Question.Difficulty.Filtered[Question.Difficulty.Filtered$Correct == TRUE,]) +
geom_bar(mapping = aes(x = style, fill = style))
ggplot(data = Question.Difficulty.Filtered[Question.Difficulty.Filtered$Correct == TRUE,]) +
geom_bar(mapping = aes(x = style, fill = style)) +
coord_cartesian(ylim = c(3000, 3500))
ggplot(data = Question.Difficulty.Filtered[Question.Difficulty.Filtered$Correct == TRUE,]) +
geom_bar(mapping = aes(x = style, fill = style)) +
coord_cartesian(ylim = c(3200, 3500))
cat("P-value: ", chisq.test(table(Question.Difficulty.Filtered$Correct, Question.Difficulty.Filtered$style))$p.value)
table(Question.Difficulty.Filtered$Correct, Question.Difficulty.Filtered$style)
install.packages("rcompanion")
library(rcompanion)
library("rcompanion")
?pairwise.wilcox.test
?pairwise.prop.test
?pairwise.table
ggplot(data = Question.Difficulty.Filtered[Question.Difficulty.Filtered$Correct == TRUE,]) +
geom_bar(mapping = aes(x = style, fill = style)) +
coord_cartesian(ylim = c(3200, 3500))
?choose
choose(4,2)
test <- table(Question.Difficulty.Filtered$style,
Question.Difficulty.Filtered$Correct)
test
names(test)
nrow(test)
?table
row.names(test)
row.names(test[1:2,])
paste(row.names(test[1:2,]), "-")
collapse(row.names(test[1:2,]), "-")
paste(row.names(test[1:2,]), collapse = "-")
